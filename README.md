### è½¯ä»¶ä»‹ç»

---

1. ä¸€æ¬¾èƒ½å¤Ÿå°†OneNoteç¬”è®°ç›´æ¥å¯¼å‡ºæˆmarkdownå’ŒJoplinæ ¼å¼çš„è½¯ä»¶ï¼Œæˆ‘åœ¨åŸä½œè€…çš„ç¨‹åºåŸºç¡€ä¸Šæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚

2. OneNote to markdownåŸç†ï¼šå…¶å®æ˜¯å°†OneNoteç¬”è®°å…ˆå¯¼å‡ºæˆWordæ–‡æ¡£ï¼Œä¹‹åé€šè¿‡pandoc.exeå°†wordè½¬åŒ–ä¸ºmarkdownï¼Œå°†å›¾ç‰‡å’Œé™„ä»¶æ”¾åœ¨ä¸€ä¸ªresourceæ–‡ä»¶å¤¹ä¸­ã€‚

3. ç¨‹åºçš„exeæ–‡ä»¶ä½äºï¼šRelease\net5.0\win-x86\\**OneNoteMdExporter.exe**
   
4. å¯¼å‡ºè·¯å¾„ä¸ºï¼šRelease\net5.0\win-x86\\Exports
   
5. #### æ³¨æ„ï¼ï¼ï¼ ä¸€å®šè¦å°†è§£å‹pandocç›®å½•ä¸‹çš„å‹ç¼©åŒ…ï¼Œå¹¶ä¸”å°†é‡Œé¢çš„exeæ–‡ä»¶æ”¾å…¥pandocç›®å½•ä¸‹ï¼Œä¸ç„¶ç¨‹åºä¼šå¡æ­»ã€‚

---


### æ”¹è¿›äº†ä»€ä¹ˆï¼Ÿ

---

1. æ·»åŠ äº†ä¸­æ–‡è¯­è¨€æ–‡ä»¶ï¼Œè®©æ•´ä¸ªæµç¨‹éƒ½æ˜¯ä¸­æ–‡

2. åŸä½œè€…è®¾è®¡æ˜¯ä¸€ä¸ªç¬”è®°æœ¬çš„æ‰€æœ‰å›¾ç‰‡éƒ½å­˜æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹è·¯å¾„ä¸º:"../../\_resource"ã€‚ä½†æ˜¯å¯¹æˆ‘æ¥è¯´è¿™éå¸¸ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘å®ç°äº†ï¼Œæ¯ä¸€ä¸ªåˆ†åŒºéƒ½æ‹¥æœ‰ç‹¬ç«‹çš„"_resource"æ–‡ä»¶å¤¹å­˜æ”¾å›¾ç‰‡æ–‡ä»¶ã€‚

3. æ·»åŠ äº†ä¸€äº›ä¸­æ–‡æ³¨é‡Šï¼Œç”±äºæˆ‘å¸¸å¹´å†™çš„éƒ½æ˜¯Cè¯­è¨€ï¼Œæ‰€ä»¥C#å’Œä»£ç æ°´å¹³å‡æœ‰é™ï¼Œå¯èƒ½æœ‰ä¸€äº›æ³¨é‡Šæ˜¯é”™è¯¯çš„ï¼Œè¿˜è¯·å„ä½å¤§ä½¬è§è°…ã€‚

4. è¯¥ç¨‹åºéµå®ˆGNU GPL V3å¼€æºåè®®ï¼Œå¼•ç”¨è¯¥ç¨‹åºéƒ½éœ€è¦å¼€æºå¹¶ä¸”ç»§ç»­æ²¿ç”¨è¯¥åè®®

5. æ”¹è¿›æ•ˆæœï¼š

   ![image1](_resources/image1.png)

   ![image2](_resources/image2.png)

### åæ§½
---
1. è¿™ä¸ªä½œè€…è®¾ç½®è·¯å¾„ï¼Œå°±æ˜¯ä¸€ç›´åœ¨å¥—å¨ƒï¼Œæå¾—æˆ‘ä¿®æ”¹ä»£ç èµ·æ¥éå¸¸ç—›è‹¦
2. ä¸ºäº†è¿™ä¸ªå°å°çš„åŠŸèƒ½æ”¹äº†æˆ‘2å¤©æ—¶é—´ï¼Œå¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©çš„è¯ï¼Œè¿˜è¯·ä½ ä»¬èƒ½å¤Ÿç»™æˆ‘ä¸ª**star**ï¼Œè°¢è°¢å„ä½å¤§ä½¬ã€‚

### ä¿®æ”¹ä½ç½®ï¼š

---

1.  åœ¨Resourcesæ–‡ä»¶å¤¹ä¸‹æ·»åŠ äº†â€trad.zh.jsonâ€œæ”¯æŒä¸­æ–‡è¯­è¨€çš„æ–‡ä»¶
2.  GetAttachmentFilePathOnPage(Attachement attachement)ï¼šå®šä¹‰äº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œç›®çš„æ˜¯ä¸ºäº†å®ç°æ–‡ä»¶å¤¹çš„è¿ç§»ã€‚
3.  void PreparePageExport(Page page)ï¼šä¿®æ”¹äº†ä¸€ä¸‹è¯¥å‡½æ•°ï¼Œè®©åˆ›å»ºåˆ†åŒºæ–‡ä»¶å¤¹çš„æ—¶å€™ï¼ŒåŒæ—¶æ·»åŠ ä¸€ä¸ªâ€\_resourcesæ–‡ä»¶å¤¹â€œ
4.  ExportServiceBase.csæ–‡ä»¶ä¸‹çš„void ExportPage(Page page)ï¼Œæ³¨é‡Šæ‰äº†åŸä½œè€…çš„ä»£ç ï¼Œè®©å…¶ä¸ä¼šä¿å­˜wordæ–‡æ¡£ã€‚
5.  string GetResourceFolderPath(Node node)ï¼šæˆ‘å°†ä»¥å‰ä¿å­˜å›¾ç‰‡çš„æ–‡ä»¶å¤¹å˜ä¸ºäº†å­˜æ”¾æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚

### ä»£ç çš„ä¸»è¦æµç¨‹ï¼š

---

#### 	ä¸»è¦æ–‡ä»¶ä»‹ç»ï¼š

1. ExportServiceBase.csï¼šæ˜¯å¯¼å‡ºç¬”è®°çš„å®ç°æ–‡ä»¶ã€‚å¯¼å‡ºonenoteçš„åŸºç±»ï¼Œæ ¹æ®å¯¼å‡ºæ ¼å¼çš„ä¸åŒï¼Œä¼šç”¨åˆ°MdExportService.csã€ã€‚ã€‚ã€‚overrideçš„å‡½æ•°ã€‚

2. ./Resources/trad.{lang}.jsonï¼šé‡Œé¢æ˜¯å…³äºæç¤ºè¯­çš„æ–‡ä»¶ï¼Œä¿®æ”¹è¯­è¨€ç”¨çš„

3. Program.csï¼šå°±æ˜¯ä¸»ç¨‹åºå…¥å£

---
   #### ä¸»è¦æµç¨‹ï¼š

   1.  ExportNotebookå‡½æ•°ï¼šåœ¨ExportServiceBase.csæ–‡ä»¶

       1.  notebook.ExportFolder; //åˆ›å»ºæ€»æ–‡ä»¶å¤¹

       2.  CleanUpFolder(notebook); //åˆ›å»ºç¬”è®°æœ¬åå­—çš„æ–‡ä»¶å¤¹

       3.  Path.Combine(node.GetNotebook().ExportFolder, "resources"); // åˆ›å»ºresourceæ–‡ä»¶å¤¹

   2.  ExportNotebookInTargetFormat(notebook, sectionNameFilter, pageNameFilter) : æŠ½è±¡å‡½æ•°ï¼Œåœ¨MdExportService.cs é‡Œæœ‰å…·ä½“çš„å‡½æ•°

       1. //è·å–æ‰€æœ‰çš„èŠ‚å’ŒèŠ‚ç»„

   3. ExportPage(Page page) //å¯¼å‡ºé¡µé¢ï¼Œåœ¨ExportServiceBase.csæ–‡ä»¶

      1. //PreparePageExport(page); //åˆ›å»ºé¡µé¢æ–‡ä»¶å¤¹
      2. //è¯·æ±‚OneNoteå°†é¡µé¢å¯¼å‡ºä¸ºDocXæ–‡ä»¶
      3. //åˆ©ç”¨PanDoc.exeå°†Wordè½¬ä¸ºMdï¼›

   4. ExtractImagesToResourceFolderï¼š//ä¿å­˜å›¾ç‰‡åˆ°resourceæ–‡ä»¶å¤¹ï¼Œåœ¨ExportServiceBase.csæ–‡ä»¶

      â€‹	1. //é€šè¿‡éå†ï¼Œä¿å­˜å›¾ç‰‡åˆ°æŒ‡å®šæ–‡ä»¶å¤¹

   5. ExportPageAttachmentsï¼š//å¯¼å‡ºæ‰€æœ‰çš„æ–‡ä»¶é™„ä»¶ï¼Œå¹¶å¾—åˆ°æ›´æ–°çš„é¡µé¢markdownï¼Œåœ¨ExportServiceBase.csæ–‡ä»¶


### åŸä½œè€…å’ŒåŸç¨‹åº

---

[alxnbl/onenote-md-exporter: ConsoleApp to export OneNote notebooks to Markdown formats (github.com)](https://github.com/alxnbl/onenote-md-exporter)

### ä¸¤ç§æ ¼å¼çš„æ•ˆæœï¼š

---

| Export format:                  | Markdown                                                     | Joplin                                                       |
| ------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Hierarchy of sections           | âœ… Folder hierarchy                                           | âœ… Notbook hierarchy                                          |
| Page ordering inside a section  | ğŸ”´ Lost                                                       | âœ…                                                            |
| Page hierarchy (level)          | âœ…                                                            | âœ…                                                            |
| Attachments                     | ğŸŸ  File of certain extensions are lost (wma, wmv, mpg, svg, mp3) | ğŸŸ  File of certain extensions are lost (wma, wmv, mpg, svg, mp3) |
| Image                           | âœ…                                                            | âœ…                                                            |
| Table                           | âœ…                                                            | âœ…                                                            |
| Table with nested image         | ğŸŸ  Html table, image lost                                     | ğŸŸ  Html table, image lost                                     |
| Font color and background color | ğŸ”´                                                            | ğŸ”´                                                            |
| Drawing                         | ğŸŸ  Flattened as image                                         | ğŸŸ  Flattened as image                                         |
| Handwriting                     | ğŸ”´ Lost                                                       | ğŸ”´ Lost                                                       |
| Text tags (task, star...)       | ğŸ”´ Lost                                                       | ğŸ”´ Lost                                                       |
| Password protected sections     | ğŸ”´ Lost                                                       | ğŸ”´ Lost                                                       |
| Notebook internal link          | ğŸ”´ onenote:// url                                             | ğŸ”´ onenote:// url                                             |

# Licence

Released under the GPL, version 3.

This software carries no warranty of any kind. Some data can be lost during the export process. I recommend to review your notes after export and keep a backup of your OneNote notebooks just in case.

### Pandoc licence terms

---

OneNote Md Exporter uses PanDoc universal markup converter.

Pandoc is available at https://github.com/jgm/pandoc

Pandoc is released under the following licence terms, full licence details can be found on the pandoc site.

```
Â© 2006-2021 John MacFarlane (jgm@berkeley.edu). Released under the GPL, version 2 or greater. This software carries no warranty of any kind.
```

#### Data:

---

**2021.12.05**







